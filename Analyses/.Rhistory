Actual=case_when(trial==1|trial==2|trial==3|trial==4|trial==5~"left", trial==6|trial==7|trial==8|trial==9|trial==10~"right", T~"away"),
Prop=N.correct/N.all) %>%
subset(Actual==Prediction) %>% select(-tmp, -Category)
d.o.a.3 <- d.o.a %>% subset(!Prop.face==0) %>%
mutate(tmp=str_replace_all(Annotation, c("^left$"="_right", "^right$"="_left", "^away$"="away", "^noface$"="noface")),
Prediction=str_replace_all(tmp, c("^_left$"="left", "^_right$"="right")),
Actual=case_when(trial==1|trial==2|trial==3|trial==4|trial==5~"left", trial==6|trial==7|trial==8|trial==9|trial==10~"right", T~"away"),
Y=case_when(Actual==Prediction~1, T~0)) %>% select(-tmp)
# Descriptive stats
d.o.n %>% subset(Prop.face==0) %>% select(filename) %>% nrow() # 13254
d.o.a %>% subset(Prop.face==0) %>% select(filename) %>% nrow() # 4874
d.o.n %>% mutate(Face=case_when(Prop.face==0 ~ "Failure", TRUE ~ "Success")) %>% select(Face) %>% table() # 40.1% excluded
d.o.a %>% mutate(Face=case_when(Prop.face==0 ~ "Failure", TRUE ~ "Success")) %>% select(Face) %>% table() # 15.1% excluded
d.o.n.2 %>% summarize(N = n(), M.Prop = mean(Prop), SD.Prop=sd(Prop)) # Non-Anonymized
d.o.a.2 %>% summarize(N = n(), M.Prop = mean(Prop), SD.Prop=sd(Prop)) # Anonymized
fit.g.o.n <- glmer(cbind(N.correct, N.all-N.correct) ~ Lighting + Distance + Position + Rotation + Country + (1|id), data=d.o.n.2, family=binomial,
# control=glmerControl(optimizer="nlminbwrap", calc.derivs = FALSE, optCtrl = list(maxfun = 10000, maxiter=100000)))
control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
summary(fit.g.o.n)
Anova(fit.g.o.n)
tmp <- summary(fit.g.o.n)$coefficients %>% as.data.frame() %>% mutate(Monitor="Large", Anonym="Non-anonymized") %>%
rownames_to_column(var="Term")
coef.o <- coef.o %>% rbind(tmp)
fit.g.o.a <- glmer(cbind(N.correct, N.all-N.correct) ~ Lighting + Distance + Position + Rotation + Country + (1|id), data=d.o.a.2, family=binomial,
# control=glmerControl(optimizer="nlminbwrap", calc.derivs = FALSE, optCtrl = list(maxfun = 10000, maxiter=100000)))
control=glmerControl(optimizer="bobyqa",optCtrl=list(maxfun=2e5)))
summary(fit.g.o.a)
Anova(fit.g.o.a)
tmp <- summary(fit.g.o.a)$coefficients %>% as.data.frame() %>% mutate(Monitor="Large", Anonym="Anonymized") %>%
rownames_to_column(var="Term")
coef.o <- coef.o %>% rbind(tmp)
coef.o %>% mutate(Term=gsub(Term, pattern="\n", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern=" ", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\(", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\)", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingLeft", replacement="Lighting (Left)", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingRight", replacement="Lighting (Right)", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceMiddle60cm", replacement="Distance (Middle)", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceFar90cm", replacement="Distance (Far)", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionLeft24cm", replacement="Offset (Left)", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionRight24cm", replacement="Offset (Right)", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationLeft", replacement="Rotation (Left)", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationRight", replacement="Rotation (Right)", ignore.case=TRUE)) %>%
subset(Term!="Intercept" & Term!="CountryJapan") %>%
mutate(Monitor=factor(Monitor, levels=c("Small", "Medium", "Large")),
Anonym=factor(Anonym, levels=c("Non-anonymized", "Anonymized")),
Term=factor(Term, levels=c("Offset (Left)", "Offset (Right)", "Distance (Middle)", "Distance (Far)", "Rotation (Left)", "Rotation (Right)", "Lighting (Left)", "Lighting (Right)"))) %>%
ggplot(aes(x=Term, fill=Anonym))+
geom_bar(aes(y=Estimate), stat="identity", position=position_dodge(0.4), width=0.4)+
geom_abline(slope=0, intercept=0, color="gray30", lwd=0.5)+
scale_y_continuous(limits=c(-0.8,0.8), breaks=seq(-0.6,0.6,0.3))+
labs(title="iCatcher+", x="")+
theme_bw()+
scale_fill_manual(values=c("#336666", "#99CCCC"))+
facet_grid(Monitor~.)+
theme(plot.title=element_text(size=16,face="bold", color="black"),
axis.ticks=element_line(color = "black"),
axis.text.x=element_text(size=14, color = "black", angle=45, hjust=1),
axis.text=element_text(size=14, color = "black"),
axis.title=element_text(size=14, color="black"),
strip.text=element_text(size=14),
legend.title=element_blank(),
legend.text=element_text(size=12, color="black"),
legend.position="bottom") -> gp
print(gp)
coef.o %>% mutate(Term=gsub(Term, pattern="\n", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern=" ", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\(", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\)", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingLeft", replacement="Lighting (Left)", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingRight", replacement="Lighting (Right)", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceMiddle60cm", replacement="Distance (Middle)", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceFar90cm", replacement="Distance (Far)", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionLeft24cm", replacement="Offset (Left)", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionRight24cm", replacement="Offset (Right)", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationLeft", replacement="Rotation (Left)", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationRight", replacement="Rotation (Right)", ignore.case=TRUE)) %>%
subset(Term!="Intercept" & Term!="CountryJapan") %>%
mutate(Monitor=factor(Monitor, levels=c("Small", "Medium", "Large")),
Anonym=factor(Anonym, levels=c("Non-anonymized", "Anonymized")),
Term=factor(Term, levels=c("Offset (Left)", "Offset (Right)", "Distance (Middle)", "Distance (Far)", "Rotation (Left)", "Rotation (Right)", "Lighting (Left)", "Lighting (Right)"))) %>%
ggplot(aes(x=Term, fill=Anonym))+
geom_bar(aes(y=Estimate), stat="identity", position=position_dodge(0.4), width=0.4)+
geom_abline(slope=0, intercept=0, color="gray30", lwd=0.5)+
scale_y_continuous(limits=c(-0.8,0.8), breaks=seq(-0.6,0.6,0.3))+
labs(title="OWLET", x="")+
theme_bw()+
scale_fill_manual(values=c("#336666", "#99CCCC"))+
facet_grid(Monitor~.)+
theme(plot.title=element_text(size=16,face="bold", color="black"),
axis.ticks=element_line(color = "black"),
axis.text.x=element_text(size=14, color = "black", angle=45, hjust=1),
axis.text=element_text(size=14, color = "black"),
axis.title=element_text(size=14, color="black"),
strip.text=element_text(size=14),
legend.title=element_blank(),
legend.text=element_text(size=12, color="black"),
legend.position="bottom") -> gp
print(gp)
coef.i %>% mutate(Algorithm="iCatcher+")
coef.i <- coef
coef.i %>% mutate(Algorithm="iCatcher+")
coef <- coef.i %>% mutate(Algorithm="iCatcher+") %>%
rbind(corf.o %>% mutate(Algorithm="OWLET"))
coef <- coef.i %>% mutate(Algorithm="iCatcher+") %>%
rbind(coef.o %>% mutate(Algorithm="OWLET"))
View(coef)
coef %>% mutate(Term=gsub(Term, pattern="\n", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern=" ", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\(", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\)", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingLeft", replacement="Lighting (Left)", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingRight", replacement="Lighting (Right)", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceMiddle60cm", replacement="Distance (Middle)", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceFar90cm", replacement="Distance (Far)", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionLeft24cm", replacement="Offset (Left)", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionRight24cm", replacement="Offset (Right)", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationLeft", replacement="Rotation (Left)", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationRight", replacement="Rotation (Right)", ignore.case=TRUE)) %>%
subset(Term!="Intercept" & Term!="CountryJapan") %>%
mutate(Monitor=factor(Monitor, levels=c("Small", "Medium", "Large")),
Anonym=factor(Anonym, levels=c("Non-anonymized", "Anonymized")),
Term=factor(Term, levels=c("Offset (Left)", "Offset (Right)", "Distance (Middle)", "Distance (Far)", "Rotation (Left)", "Rotation (Right)", "Lighting (Left)", "Lighting (Right)"))) %>%
ggplot(aes(x=Term, fill=Anonym))+
geom_bar(aes(y=Estimate), stat="identity", position=position_dodge(0.4), width=0.4)+
geom_abline(slope=0, intercept=0, color="gray30", lwd=0.5)+
scale_y_continuous(limits=c(-0.8,0.8), breaks=seq(-0.6,0.6,0.3))+
# labs(title="OWLET", x="")+
theme_bw()+
scale_fill_manual(values=c("#336666", "#99CCCC"))+
facet_grid(Monitor~Algorithm)+
theme(plot.title=element_text(size=16,face="bold", color="black"),
axis.ticks=element_line(color = "black"),
axis.text.x=element_text(size=14, color = "black", angle=45, hjust=1),
axis.text=element_text(size=14, color = "black"),
axis.title=element_text(size=14, color="black"),
strip.text=element_text(size=14),
legend.title=element_blank(),
legend.text=element_text(size=12, color="black"),
legend.position="bottom") -> gp
print(gp)
ggsave(file=here("Figures", "Figure_5.png"), plot=gp, dpi=350, width=7.7, height=6.5)
coef %>% mutate(Term=gsub(Term, pattern="\n", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern=" ", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\(", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\)", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingLeft", replacement="Lighting (Left)", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingRight", replacement="Lighting (Right)", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceMiddle60cm", replacement="Distance (Middle)", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceFar90cm", replacement="Distance (Far)", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionLeft24cm", replacement="Offset (Left)", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionRight24cm", replacement="Offset (Right)", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationLeft", replacement="Rotation (Left)", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationRight", replacement="Rotation (Right)", ignore.case=TRUE)) %>%
subset(Term!="Intercept" & Term!="CountryJapan") %>%
mutate(Monitor=factor(Monitor, levels=c("Small", "Medium", "Large")),
Anonym=factor(Anonym, levels=c("Non-anonymized", "Anonymized")),
Term=factor(Term, levels=c("Offset (Left)", "Offset (Right)", "Distance (Middle)", "Distance (Far)", "Rotation (Left)", "Rotation (Right)", "Lighting (Left)", "Lighting (Right)"))) %>%
ggplot(aes(x=Term, fill=Anonym))+
geom_bar(aes(y=Estimate), stat="identity", position=position_dodge(0.4), width=0.4)+
geom_abline(slope=0, intercept=0, color="gray30", lwd=0.5)+
scale_y_continuous(limits=c(-0.8,0.8), breaks=seq(-0.6,0.6,0.3))+
labs(title="", x="")+
theme_bw()+
scale_fill_manual(values=c("#336666", "#99CCCC"))+
facet_grid(Monitor~Algorithm)+
theme(plot.title=element_text(size=16,face="bold", color="black"),
axis.ticks=element_line(color = "black"),
axis.text.x=element_text(size=14, color = "black", angle=45, hjust=1),
axis.text=element_text(size=14, color = "black"),
axis.title=element_text(size=14, color="black"),
strip.text=element_text(size=14),
legend.title=element_blank(),
legend.text=element_text(size=12, color="black"),
legend.position="bottom") -> gp
print(gp)
ggsave(file=here("Figures", "Figure_5.png"), plot=gp, dpi=350, width=7.7, height=6.5)
ggsave(file=here("Figures", "Figure_5.png"), plot=gp, dpi=350, width=8.3, height=7)
ggsave(file=here("Figures", "Figure_5.png"), plot=gp, dpi=350, width=7.7, height=7)
View(coef.o)
coef.o %>% mutate(Term=gsub(Term, pattern="\n", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern=" ", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\(", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\)", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingLeft", replacement="Lighting (Left)", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingRight", replacement="Lighting (Right)", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceMiddle60cm", replacement="Distance (Middle)", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceFar90cm", replacement="Distance (Far)", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionLeft24cm", replacement="Offset (Left)", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionRight24cm", replacement="Offset (Right)", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationLeft", replacement="Rotation (Left)", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationRight", replacement="Rotation (Right)", ignore.case=TRUE)) %>%
subset(Term!="Intercept" & Term!="CountryJapan") %>%
separate(name, c("Noise factors", "Condition"), sep=" ")
coef.o %>% mutate(Term=gsub(Term, pattern="\n", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern=" ", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\(", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\)", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingLeft", replacement="Lighting (Left)", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingRight", replacement="Lighting (Right)", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceMiddle60cm", replacement="Distance (Middle)", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceFar90cm", replacement="Distance (Far)", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionLeft24cm", replacement="Offset (Left)", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionRight24cm", replacement="Offset (Right)", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationLeft", replacement="Rotation (Left)", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationRight", replacement="Rotation (Right)", ignore.case=TRUE)) %>%
subset(Term!="Intercept" & Term!="CountryJapan") %>%
separate(Term, c("Noise factors", "Condition"), sep=" ")
coef.o %>% mutate(Term=gsub(Term, pattern="\n", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern=" ", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\(", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\)", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingLeft", replacement="Lighting Left", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingRight", replacement="Lighting Right", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceMiddle60cm", replacement="Distance Middle", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceFar90cm", replacement="Distance Far", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionLeft24cm", replacement="Offset Left", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionRight24cm", replacement="Offset Right", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationLeft", replacement="Rotation Left", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationRight", replacement="Rotation Right", ignore.case=TRUE)) %>%
subset(Term!="Intercept" & Term!="CountryJapan") %>%
separate(Term, c("Noise factors", "Condition"), sep=" ")
coef.o %>% mutate(Term=gsub(Term, pattern="\n", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern=" ", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\(", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\)", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingLeft", replacement="Lighting Left", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingRight", replacement="Lighting Right", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceMiddle60cm", replacement="Distance Middle", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceFar90cm", replacement="Distance Far", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionLeft24cm", replacement="Offset Left", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionRight24cm", replacement="Offset Right", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationLeft", replacement="Rotation Left", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationRight", replacement="Rotation Right", ignore.case=TRUE)) %>%
subset(Term!="Intercept" & Term!="CountryJapan") %>%
separate(Term, c("Factor", "Condition"), sep=" ") %>%
mutate(Monitor=factor(Monitor, levels=c("Small", "Medium", "Large")),
Anonym=factor(Anonym, levels=c("Non-anonymized", "Anonymized")),
Factor=factor(Factor, levels=c("Offset", "Distance", "Rotation", "Lighting")),
Condition=factor(Condition, levels=c("Left", "Right", "Middle", "Far"))) %>%
ggplot(aes(x=Condition, fill=Anonym))+
geom_bar(aes(y=Estimate), stat="identity", position=position_dodge(0.4), width=0.4)+
geom_abline(slope=0, intercept=0, color="gray30", lwd=0.5)+
scale_y_continuous(limits=c(-0.8,0.8), breaks=seq(-0.6,0.6,0.3))+
labs(title="OWLET", x="")+
theme_bw()+
scale_fill_manual(values=c("#336666", "#99CCCC"))+
facet_grid(Monitor~Factor)+
theme(plot.title=element_text(size=16,face="bold", color="black"),
axis.ticks=element_line(color = "black"),
axis.text.x=element_text(size=14, color = "black", angle=45, hjust=1),
axis.text=element_text(size=14, color = "black"),
axis.title=element_text(size=14, color="black"),
strip.text=element_text(size=14),
legend.title=element_blank(),
legend.text=element_text(size=12, color="black"),
legend.position="bottom") -> gp
print(gp)
coef.o %>% mutate(Term=gsub(Term, pattern="\n", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern=" ", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\(", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\)", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingLeft", replacement="Lighting Left", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingRight", replacement="Lighting Right", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceMiddle60cm", replacement="Distance Middle", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceFar90cm", replacement="Distance Far", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionLeft24cm", replacement="Offset Left", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionRight24cm", replacement="Offset Right", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationLeft", replacement="Rotation Left", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationRight", replacement="Rotation Right", ignore.case=TRUE)) %>%
subset(Term!="Intercept" & Term!="CountryJapan") %>%
separate(Term, c("Factor", "Condition"), sep=" ") %>%
mutate(Monitor=factor(Monitor, levels=c("Small", "Medium", "Large")),
Anonym=factor(Anonym, levels=c("Non-anonymized", "Anonymized")),
Factor=factor(Factor, levels=c("Offset", "Distance", "Rotation", "Lighting")),
Condition=factor(Condition, levels=c("Left", "Right", "Middle", "Far"))) %>%
ggplot(aes(x=Condition, fill=Anonym))+
geom_bar(aes(y=Estimate), stat="identity", position=position_dodge(0.4), width=0.4)+
geom_abline(slope=0, intercept=0, color="gray30", lwd=0.5)+
scale_y_continuous(limits=c(-0.8,0.8), breaks=seq(-0.6,0.6,0.3))+
labs(title="OWLET", x="")+
theme_bw()+
scale_fill_manual(values=c("#336666", "#99CCCC"))+
facet_wrap(Monitor~Factor)+
theme(plot.title=element_text(size=16,face="bold", color="black"),
axis.ticks=element_line(color = "black"),
axis.text.x=element_text(size=14, color = "black", angle=45, hjust=1),
axis.text=element_text(size=14, color = "black"),
axis.title=element_text(size=14, color="black"),
strip.text=element_text(size=14),
legend.title=element_blank(),
legend.text=element_text(size=12, color="black"),
legend.position="bottom") -> gp
print(gp)
coef.o %>% mutate(Term=gsub(Term, pattern="\n", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern=" ", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\(", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\)", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingLeft", replacement="Lighting Left", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingRight", replacement="Lighting Right", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceMiddle60cm", replacement="Distance Middle", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceFar90cm", replacement="Distance Far", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionLeft24cm", replacement="Offset Left", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionRight24cm", replacement="Offset Right", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationLeft", replacement="Rotation Left", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationRight", replacement="Rotation Right", ignore.case=TRUE)) %>%
subset(Term!="Intercept" & Term!="CountryJapan") %>%
separate(Term, c("Factor", "Condition"), sep=" ") %>%
mutate(Monitor=factor(Monitor, levels=c("Small", "Medium", "Large")),
Anonym=factor(Anonym, levels=c("Non-anonymized", "Anonymized")),
Factor=factor(Factor, levels=c("Offset", "Distance", "Rotation", "Lighting")),
Condition=factor(Condition, levels=c("Left", "Right", "Middle", "Far"))) %>%
ggplot(aes(x=Condition, fill=Anonym))+
geom_bar(aes(y=Estimate), stat="identity", position=position_dodge(0.4), width=0.4)+
geom_abline(slope=0, intercept=0, color="gray30", lwd=0.5)+
scale_y_continuous(limits=c(-0.8,0.8), breaks=seq(-0.6,0.6,0.3))+
labs(title="OWLET", x="")+
theme_bw()+
scale_fill_manual(values=c("#336666", "#99CCCC"))+
facet_grid(Monitor~Factor)+
theme(plot.title=element_text(size=16,face="bold", color="black"),
axis.ticks=element_line(color = "black"),
axis.text.x=element_text(size=14, color = "black", angle=45, hjust=1),
axis.text=element_text(size=14, color = "black"),
axis.title=element_text(size=14, color="black"),
strip.text=element_text(size=14),
legend.title=element_blank(),
legend.text=element_text(size=12, color="black"),
legend.position="bottom") -> gp
print(gp)
coef.o %>% mutate(Term=gsub(Term, pattern="\n", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern=" ", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\(", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\)", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingLeft", replacement="Lighting Left", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingRight", replacement="Lighting Right", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceMiddle60cm", replacement="Distance Middle", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceFar90cm", replacement="Distance Far", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionLeft24cm", replacement="Offset Left", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionRight24cm", replacement="Offset Right", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationLeft", replacement="Rotation Left", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationRight", replacement="Rotation Right", ignore.case=TRUE)) %>%
subset(Term!="Intercept" & Term!="CountryJapan") %>%
separate(Term, c("Factor", "Condition"), sep=" ") %>%
mutate(Monitor=factor(Monitor, levels=c("Small", "Medium", "Large")),
Anonym=factor(Anonym, levels=c("Non-anonymized", "Anonymized")),
Factor=factor(Factor, levels=c("Offset", "Distance", "Rotation", "Lighting"))) %>%
ggplot(aes(x=Condition, fill=Anonym))+
geom_bar(aes(y=Estimate), stat="identity", position=position_dodge(0.4), width=0.4)+
geom_abline(slope=0, intercept=0, color="gray30", lwd=0.5)+
scale_y_continuous(limits=c(-0.8,0.8), breaks=seq(-0.6,0.6,0.3))+
labs(title="OWLET", x="")+
theme_bw()+
scale_fill_manual(values=c("#336666", "#99CCCC"))+
facet_grid(Monitor~Factor)+
theme(plot.title=element_text(size=16,face="bold", color="black"),
axis.ticks=element_line(color = "black"),
axis.text.x=element_text(size=14, color = "black", angle=45, hjust=1),
axis.text=element_text(size=14, color = "black"),
axis.title=element_text(size=14, color="black"),
strip.text=element_text(size=14),
legend.title=element_blank(),
legend.text=element_text(size=12, color="black"),
legend.position="bottom") -> gp
print(gp)
coef.o %>% mutate(Term=gsub(Term, pattern="\n", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern=" ", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\(", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\)", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingLeft", replacement="Lighting Left", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingRight", replacement="Lighting Right", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceMiddle60cm", replacement="Distance Middle", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceFar90cm", replacement="Distance Far", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionLeft24cm", replacement="Offset Left", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionRight24cm", replacement="Offset Right", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationLeft", replacement="Rotation Left", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationRight", replacement="Rotation Right", ignore.case=TRUE)) %>%
subset(Term!="Intercept" & Term!="CountryJapan") %>%
separate(Term, c("Factor", "Condition"), sep=" ") %>%
mutate(Monitor=factor(Monitor, levels=c("Small", "Medium", "Large")),
Anonym=factor(Anonym, levels=c("Non-anonymized", "Anonymized")),
Factor=factor(Factor, levels=c("Offset", "Distance", "Rotation", "Lighting")),
Condition=factor(Condition, levels=c("Left", "Right", "Middle", "Far"))) %>%
ggplot(aes(x=Condition, fill=Anonym))+
geom_bar(aes(y=Estimate), stat="identity", position=position_dodge(0.4), width=0.4)+
geom_abline(slope=0, intercept=0, color="gray30", lwd=0.5)+
scale_y_continuous(limits=c(-0.8,0.8), breaks=seq(-0.6,0.6,0.3))+
labs(title="OWLET", x="")+
theme_bw()+
scale_fill_manual(values=c("#336666", "#99CCCC"))+
facet_grid(Monitor~Factor, space = "free")+
theme(plot.title=element_text(size=16,face="bold", color="black"),
axis.ticks=element_line(color = "black"),
axis.text.x=element_text(size=14, color = "black", angle=45, hjust=1),
axis.text=element_text(size=14, color = "black"),
axis.title=element_text(size=14, color="black"),
strip.text=element_text(size=14),
legend.title=element_blank(),
legend.text=element_text(size=12, color="black"),
legend.position="bottom") -> gp
print(gp)
coef.o %>% mutate(Term=gsub(Term, pattern="\n", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern=" ", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\(", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\)", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingLeft", replacement="Lighting Left", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingRight", replacement="Lighting Right", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceMiddle60cm", replacement="Distance Middle", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceFar90cm", replacement="Distance Far", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionLeft24cm", replacement="Offset Left", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionRight24cm", replacement="Offset Right", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationLeft", replacement="Rotation Left", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationRight", replacement="Rotation Right", ignore.case=TRUE)) %>%
subset(Term!="Intercept" & Term!="CountryJapan") %>%
separate(Term, c("Factor", "Condition"), sep=" ") %>%
mutate(Monitor=factor(Monitor, levels=c("Small", "Medium", "Large")),
Anonym=factor(Anonym, levels=c("Non-anonymized", "Anonymized")),
Factor=factor(Factor, levels=c("Offset", "Distance", "Rotation", "Lighting")),
Condition=factor(Condition, levels=c("Left", "Right", "Middle", "Far"))) %>%
ggplot(aes(x=Condition, fill=Anonym))+
geom_bar(aes(y=Estimate), stat="identity", position=position_dodge(0.4), width=0.4)+
geom_abline(slope=0, intercept=0, color="gray30", lwd=0.5)+
scale_y_continuous(limits=c(-0.8,0.8), breaks=seq(-0.6,0.6,0.3))+
labs(title="OWLET", x="")+
theme_bw()+
scale_fill_manual(values=c("#336666", "#99CCCC"))+
facet_grid(Monitor~Factor, scale="free")+
theme(plot.title=element_text(size=16,face="bold", color="black"),
axis.ticks=element_line(color = "black"),
axis.text.x=element_text(size=14, color = "black", angle=45, hjust=1),
axis.text=element_text(size=14, color = "black"),
axis.title=element_text(size=14, color="black"),
strip.text=element_text(size=14),
legend.title=element_blank(),
legend.text=element_text(size=12, color="black"),
legend.position="bottom") -> gp
print(gp)
ggsave(file=here("Figures", "Figure_5_OWLET.png"), plot=gp, dpi=350, width=5, height=7)
coef.o %>% mutate(Term=gsub(Term, pattern="\n", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern=" ", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\(", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\)", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingLeft", replacement="Lighting Left", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingRight", replacement="Lighting Right", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceMiddle60cm", replacement="Distance Middle", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceFar90cm", replacement="Distance Far", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionLeft24cm", replacement="Offset Left", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionRight24cm", replacement="Offset Right", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationLeft", replacement="Rotation Left", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationRight", replacement="Rotation Right", ignore.case=TRUE)) %>%
subset(Term!="Intercept" & Term!="CountryJapan") %>%
separate(Term, c("Factor", "Condition"), sep=" ") %>%
mutate(Monitor=factor(Monitor, levels=c("Small", "Medium", "Large")),
Anonym=factor(Anonym, levels=c("Non-anonymized", "Anonymized")),
Factor=factor(Factor, levels=c("Offset", "Distance", "Rotation", "Lighting")),
Condition=factor(Condition, levels=c("Left", "Right", "Middle", "Far"))) %>%
ggplot(aes(x=Condition, fill=Anonym))+
geom_bar(aes(y=Estimate), stat="identity", position=position_dodge(0.4), width=0.4)+
geom_abline(slope=0, intercept=0, color="gray30", lwd=0.5)+
scale_y_continuous(limits=c(-0.8,0.8), breaks=seq(-0.6,0.6,0.3))+
labs(title="OWLET", x="")+
theme_bw()+
scale_fill_manual(values=c("#336666", "#99CCCC"))+
facet_grid(Monitor~Factor, scale="free")+
theme(plot.title=element_text(size=18,face="bold", color="black"),
axis.ticks=element_line(color = "black"),
axis.text.x=element_text(size=14, color = "black", angle=45, hjust=1),
axis.text=element_text(size=14, color = "black"),
axis.title=element_text(size=14, color="black"),
strip.text=element_text(size=14),
legend.title=element_blank(),
legend.text=element_text(size=12, color="black"),
legend.position="bottom") -> gp
print(gp)
ggsave(file=here("Figures", "Figure_5_OWLET.png"), plot=gp, dpi=350, width=5, height=7)
coef.i %>% mutate(Term=gsub(Term, pattern="\n", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern=" ", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\(", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="\\)", replacement="", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingLeft", replacement="Lighting Left", ignore.case=TRUE),
Term=gsub(Term, pattern="LightingRight", replacement="Lighting Right", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceMiddle60cm", replacement="Distance Middle", ignore.case=TRUE),
Term=gsub(Term, pattern="DistanceFar90cm", replacement="Distance Far", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionLeft24cm", replacement="Offset Left", ignore.case=TRUE),
Term=gsub(Term, pattern="PositionRight24cm", replacement="Offset Right", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationLeft", replacement="Rotation Left", ignore.case=TRUE),
Term=gsub(Term, pattern="RotationRight", replacement="Rotation Right", ignore.case=TRUE)) %>%
subset(Term!="Intercept" & Term!="CountryJapan") %>%
separate(Term, c("Factor", "Condition"), sep=" ") %>%
mutate(Monitor=factor(Monitor, levels=c("Small", "Medium", "Large")),
Anonym=factor(Anonym, levels=c("Non-anonymized", "Anonymized")),
Factor=factor(Factor, levels=c("Offset", "Distance", "Rotation", "Lighting")),
Condition=factor(Condition, levels=c("Left", "Right", "Middle", "Far"))) %>%
ggplot(aes(x=Condition, fill=Anonym))+
geom_bar(aes(y=Estimate), stat="identity", position=position_dodge(0.4), width=0.4)+
geom_abline(slope=0, intercept=0, color="gray30", lwd=0.5)+
scale_y_continuous(limits=c(-0.8,0.8), breaks=seq(-0.6,0.6,0.3))+
labs(title="iCatcher+", x="")+
theme_bw()+
scale_fill_manual(values=c("#336666", "#99CCCC"))+
facet_grid(Monitor~Factor, scale="free")+
theme(plot.title=element_text(size=18,face="bold", color="black"),
axis.ticks=element_line(color = "black"),
axis.text.x=element_text(size=14, color = "black", angle=45, hjust=1),
axis.text=element_text(size=14, color = "black"),
axis.title=element_text(size=14, color="black"),
strip.text=element_text(size=14),
legend.title=element_blank(),
legend.text=element_text(size=12, color="black"),
legend.position="bottom") -> gp
print(gp)
ggsave(file=here("Figures", "Figure_5_iCatcher.png"), plot=gp, dpi=350, width=5, height=7)
